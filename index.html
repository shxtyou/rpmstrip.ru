<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>RPM Стрип-клуб</title>
</head>
<body>
  <form id="orderForm">
    <label>Discord: <input name="discord" required></label><br>
    <label>RPM: <input name="rpm" required></label><br>
    <label>Услуга:
      <select name="service" id="service">
        <option>Минет</option>
        <option>Стандарт (1 час)</option>
      </select>
    </label><br>
    <label>Дата: <input type="datetime-local" name="date" required></label><br>
    <label>Промокод: <input type="text" name="promo" id="promo"></label><br>
    <p id="priceDisplay"></p>
    <button type="submit">Заказать</button>
  </form>

  <script>
    const servicePrices = {
      "Стандарт (1 час)": 40000,
      "Минет": 25000
    };

    const form = document.getElementById('orderForm');
    const select = document.getElementById('service');
    const promoInput = document.getElementById('promo');
    const priceDisplay = document.getElementById('priceDisplay');

    function updatePrice() {
      const service = select.value;
      const base = servicePrices[service] || 0;
      let final = base;
      let promo = promoInput.value.trim();
      if (promo === "ONYX-2025-ELITE-XR") {
        final *= 0.9;
      }
      priceDisplay.textContent = `Цена: ${final.toLocaleString()}$`;
    }

    select.addEventListener('change', updatePrice);
    promoInput.addEventListener('input', updatePrice);
    updatePrice();

    form.addEventListener('submit', async function (e) {
      e.preventDefault();
      const data = new FormData(form);
      const service = data.get("service");
      const basePrice = servicePrices[service] || 0;
      let finalPrice = basePrice;
      if (data.get("promo").trim() === "ONYX-2025-ELITE-XR") {
        finalPrice = Math.floor(basePrice * 0.9);
      }

      await fetch("https://discord.com/api/webhooks/your_webhook_url", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          content: "<@&1371644238349205535>",
          embeds: [
            {
              title: "✨ Новый заказ",
              fields: [
                { name: "Discord", value: data.get("discord"), inline: true },
                { name: "RPM", value: data.get("rpm"), inline: true },
                { name: "Услуга", value: service },
                { name: "Дата", value: data.get("date"), inline: true },
                { name: "Цена", value: `${finalPrice.toLocaleString()}$`, inline: true }
              ]
            }
          ],
          allowed_mentions: { roles: ["1371644238349205535"] }
        })
      });

      alert("Отправлено!");
    });
  </script>
</body>
</html>
