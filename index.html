<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RPM –°—Ç—Ä–∏–ø-–∫–ª—É–±</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <h1>RPM –°—Ç—Ä–∏–ø-–∫–ª—É–±</h1>

    <form id="orderForm" class="order-form">
      <label>–ù–∏–∫ –≤ Discord:
        <input type="text" name="discord" required />
      </label>

      <label>–ù–∏–∫ –Ω–∞ RPM:
        <input type="text" name="rpm" required />
      </label>

      <label>–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É:
        <select name="service" id="serviceSelect" required>
          <option value="–°—Ç–∞–Ω–¥–∞—Ä—Ç (1 —á–∞—Å)">–°—Ç–∞–Ω–¥–∞—Ä—Ç (1 —á–∞—Å)</option>
          <option value="–ú–∏–Ω–µ—Ç">–ú–∏–Ω–µ—Ç</option>
          <option value="–ñ–µ–Ω—Å–∫–æ–µ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ">–ñ–µ–Ω—Å–∫–æ–µ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</option>
          <option value="–ü–æ–¥—á–∏–Ω–µ–Ω–∏–µ">–ü–æ–¥—á–∏–Ω–µ–Ω–∏–µ</option>
          <option value="–®–∏–±–∞—Ä–∏">–®–∏–±–∞—Ä–∏</option>
          <option value="BDSM">BDSM</option>
          <option value="–°—Ç—Ä–∏–ø—Ç–∏–∑ / –ü—Ä–∏–≤–∞—Ç-—Ç–∞–Ω–µ—Ü">–°—Ç—Ä–∏–ø—Ç–∏–∑ / –ü—Ä–∏–≤–∞—Ç-—Ç–∞–Ω–µ—Ü</option>
          <option value="–°–æ–≤–º–µ—Å—Ç–Ω–∞—è –≤–∞–Ω–Ω–∞ + –º–∞—Å—Å–∞–∂">–°–æ–≤–º–µ—Å—Ç–Ω–∞—è –≤–∞–Ω–Ω–∞ + –º–∞—Å—Å–∞–∂</option>
          <option value="–ù–æ—á—å —Å–æ –º–Ω–æ–π">–ù–æ—á—å —Å–æ –º–Ω–æ–π</option>
          <option value="–§–æ—Ç–æ-/–≤–∏–¥–µ–æ—Å—ä—ë–º–∫–∞ + —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ">–§–æ—Ç–æ-/–≤–∏–¥–µ–æ—Å—ä—ë–º–∫–∞ + —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ</option>
          <option value="VIP –ö–ª–∏–µ–Ω—Ç">VIP –ö–ª–∏–µ–Ω—Ç</option>
        </select>
      </label>

      <label id="dateLabel">–ö–æ–≥–¥–∞:
        <input type="datetime-local" name="date" id="dateInput" required />
      </label>

      <label id="promoLabel">–ü—Ä–æ–º–æ–∫–æ–¥ (–µ—Å–ª–∏ –µ—Å—Ç—å):
        <input type="text" name="promo" id="promoInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥" />
      </label>

      <button type="submit" class="btn-submit">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
    </form>
  </div>

  <script>
    const webhookUrl = 'https://discord.com/api/webhooks/1377196690099933279/o4XKVX179xTD6IV9FIG-kRg9w_t8XDlBG_xewTh2uRVLJfxvgzUpJtS6rFwOw5eXSID1';
    const roleId = '1371644238349205535';

    const orderForm = document.getElementById('orderForm');
    const serviceSelect = document.getElementById('serviceSelect');
    const dateLabel = document.getElementById('dateLabel');
    const dateInput = document.getElementById('dateInput');
    const promoLabel = document.getElementById('promoLabel');

    function toggleVipFields() {
      if (serviceSelect.value === 'VIP –ö–ª–∏–µ–Ω—Ç') {
        dateLabel.style.display = 'none';
        promoLabel.style.display = 'none';
        dateInput.required = false;
      } else {
        dateLabel.style.display = 'block';
        promoLabel.style.display = 'block';
        dateInput.required = true;
      }
    }

    serviceSelect.addEventListener('change', toggleVipFields);
    toggleVipFields();

    async function sendDiscordWebhook(orderData) {
      const embed = {
        title: "üõí –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ –≤ RPM –°—Ç—Ä–∏–ø-–∫–ª—É–±",
        color: 0x7e57ff,
        fields: [
          { name: "Discord", value: orderData.discord || '–ù–µ —É–∫–∞–∑–∞–Ω', inline: true },
          { name: "RPM –ù–∏–∫", value: orderData.rpm || '–ù–µ —É–∫–∞–∑–∞–Ω', inline: true },
          { name: "–£—Å–ª—É–≥–∞", value: orderData.service || '–ù–µ —É–∫–∞–∑–∞–Ω–∞', inline: false },
        ],
        timestamp: new Date().toISOString(),
      };

      if (orderData.date) {
        embed.fields.push({ name: "–ö–æ–≥–¥–∞", value: orderData.date, inline: true });
      }
      if (orderData.promo) {
        embed.fields.push({ name: "–ü—Ä–æ–º–æ–∫–æ–¥", value: orderData.promo, inline: true });
      }

      const payload = {
        content: `<@&${roleId}>`,
        embeds: [embed]
      };

      const response = await fetch(webhookUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });

      if (!response.ok) {
        throw new Error(`–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–µ–±—Ö—É–∫–∞: ${response.statusText}`);
      }
    }

    orderForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      const formData = new FormData(orderForm);
      const orderData = {
        discord: formData.get('discord').trim(),
        rpm: formData.get('rpm').trim(),
        service: formData.get('service'),
        date: formData.get('date'),
        promo: formData.get('promo').trim()
      };

      try {
        await sendDiscordWebhook(orderData);
        alert('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª —É–≤–µ–¥–æ–º–ª—ë–Ω!');
        orderForm.reset();
        toggleVipFields();
      } catch (error) {
        console.error(error);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–∫–∞–∑–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
      }
    });
  </script>
</body>
</html>
